{% extends 'base.html.twig' %}
{% block body %}
    {% include 'include/admin_navbar.html.twig' %}
    <section class="home">
        {% include 'include/navbar_top.html.twig' %}
        <div class="container-fluid">
            <div class="card">
                {{ form_start(projeto) }}
                <div class="card-header">
                    <h3>{{ title }}</h3>
                </div>
                <div class="card-body">

                    <div class="col-lg-12" style="margin-top: 10px !important;">
                        <h4>Cliente</h4>
                        <hr/>
                        <div class="row">
                            <div class="col-lg-4">
                                {{ form_row(projeto.cliente_id, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12" style="margin-top: 10px !important;">
                        <h4>Projeto</h4>
                        <hr/>
                        <div class="row">
                            <div class="col-lg-4">
                                {{ form_row(projeto.nome, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(projeto.situacao, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(projeto.tempoGastoTotal, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(projeto.dataIniPrevisto, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(projeto.dataFimPrevisto, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(projeto.dataInicial, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(projeto.dataEntregaFinal, {'attr': {'class': 'camposInput'}}) }}
                            </div>

                            <div class="col-lg-12">
                                {{ form_row(projeto.descricao, {'attr': {'class': 'camposInput'}}) }}
                            </div>
                        </div>
                    </div>
                    <input type="hidden" value="{{ idProjeto }}" id="idProjetoForm">


                    <div class="col-lg-12" style="margin-top: 15px !important;">
                        <div class="form-group" style="float: right">
                            <button class="btn btn-danger" name="cancel" type="submit" value="Cancel" formnovalidate>
                                Cancelar
                            </button>
                            <button class="btn btn-success " type="submit">Salvar</button>
                        </div>
                    </div>
                    {{ form_end(projeto) }}
                </div>
            </div>
        </div>
    </section>

    <script>
        $(document).ready( function(){
            $('#projeto_tempoGastoTotal').attr('readonly', true);
            let idProjeto = $('#idProjetoForm').val();

            $.ajax({
                type: 'POST',
                url: 'buscarCountTempoGasto/tempoGastoProjeto',
                dataType: 'JSON',
                data: {
                    id: idProjeto
                },
                success: function (response) {
                    console.log('RESPONSE PROJETO COUNT: ',response.response[0]);
                    if(response.response[0].tempoGasto) {
                        $('#projeto_tempoGastoTotal').val(response.response[0].tempoGasto);
                    } else {
                        $('#projeto_tempoGastoTotal').val(0);
                    }

                },
                complete: function (resp) {
                    console.log(resp);
                }
            })
        })
    </script>
{% endblock %}


